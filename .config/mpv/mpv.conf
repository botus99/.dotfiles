############################################################
# MPV Configuration
# Target GPU: NVIDIA Quadro P2000 (Pascal)
#
# HW decode supported: h264, h265 (HEVC), vp9
# NOT supported: AV1 (software decode only)
#
# Manual:
# https://mpv.io/manual/stable/
############################################################


############################################################
# PLAYER / RENDERING
############################################################

# video output driver:
#   gpu-next  (modern)
#   gpu       (legacy)
vo=gpu-next

# graphics API:
#   vulkan    (modern)
#   opengl    (legacy)
gpu-api=vulkan

# hardware decoding:
#   nvdec     (nvidia)
#   auto
#   no
hwdec=auto

# keep player open after playback ends (yes/no)
keep-open=no

# cursor auto-hide (milliseconds)
cursor-autohide=1000

# resize window in case it's larger than W%xH% of the screen
autofit-larger=93%x93%

# styling
background='color'
background-color='#1d2021'
background-tile-color-0='#1d2021'
background-tile-color-1='#ebdbb2'


############################################################
# TERMINAL BEHAVIOR
############################################################

# color log messages on the terminal
msg-color=yes

# prepend module name to log messages
msg-module=yes

# display progress bar on the terminal
term-osd-bar=yes


############################################################
# CACHE / DEMUXING
############################################################

# use large seekable RAM cache even for local input
cache=yes

#cache-secs=1000
cache-pause-initial=yes

# cache sizes (requires cache=yes)
demuxer-max-bytes=4096M
demuxer-max-back-bytes=4096M

# disable framedrop during hr-seek
hr-seek-framedrop=no


############################################################
# AUDIO
############################################################

# volume defaults
volume=80
volume-max=200

# auto-load loosely matching audio files
audio-file-auto=fuzzy

# pitch correction when speed ≠ 1.0
audio-pitch-correction=yes

# fix audio popping on random seek
audio-stream-silence=no

# dynamic audio normalization
# g = max gain
# f = frame length
# r = target RMS
# p = peak limit
af-add=dynaudnorm=g=5:f=250:r=0.9:p=0.5

# audio passthrough
# codecs: ac3, eac3, dts, dts-hd, truehd
audio-spdif=dts-hd,truehd


############################################################
# COVER ART
############################################################

image-exts='jpg,jpeg,png'
cover-art-auto='exact'
cover-art-whitelist='folder,poster,cover,front,AlbumArt,Album,AlbumArtSmall,Folder,.folder,thumb'


############################################################
# OSC / OSD
############################################################

osc=yes
osd-font=Mononoki Nerd Font Mono
osd-font-size=27
osd-level=1
osd-bar=no
osd-bar-h=2
osd-bar-w=90
osd-bar-align-y=-0.85
osd-border-color='#1d2021'


############################################################
# SUBTITLES
############################################################

# external subs don't have to match file name exactly to autoload
sub-auto=fuzzy

# blend subtitles directly onto upscaled video frames
blend-subtitles=yes

# try to correctly show embedded subs when seeking
demuxer-mkv-subtitle-preroll=yes

# use embedded fonts for SSA/ASS subs
embeddedfonts=yes

# backward compatibility for vsfilter fansubs
sub-ass-use-video-data=all

# search paths
sub-file-paths-append=ass
sub-file-paths-append=srt
sub-file-paths-append=sub
sub-file-paths-append=subs
sub-file-paths-append=subtitles

# styling
sub-border-style='outline-and-shadow'
sub-color='#ebdbb2'
sub-shadow-color='#1d2021'
sub-font='Mononoki Nerd Font Mono'
sub-bold=yes
sub-font-size=48
sub-pos=100
sub-blur=3


############################################################
# LANGUAGE PREFERENCES
############################################################

alang=jpn,jp,eng,en,enUS,en-US,de,ger
slang=eng,en,und,de,ger,jp,jap


############################################################
# COLOR / HDR / TONE MAPPING
############################################################

# transfer characteristic:
# auto, bt.1886, srgb, gamma2.2, gamma2.4, pq, hlg
target-trc=auto

# output levels:
# full, limited, auto
video-output-levels=full

#gamma-auto
#vf=format=colorlevels=full:colormatrix=auto

# Tone mapping algorithms:
# clip, reinhard, hable, mobius, bt.2390
tone-mapping=bt.2390
#tone-mapping-mode=auto

# HDR peak detection
hdr-compute-peak=yes
hdr-peak-percentile=99.8


############################################################
# DITHERING
############################################################

# dither bit depth:
# auto, 8, 10, 12, 16
dither-depth=auto

# dither algorithms:
# fruit (good default)
# error-diffusion (higher quality, heavier)
# ordered
# random
# none
dither=fruit

# temporal dithering (yes/no)
temporal-dither=yes


############################################################
# DEBANDING
############################################################

deband=yes
deband-iterations=2
deband-threshold=32
deband-range=16
deband-grain=12


############################################################
# MOTION INTERPOLATION
############################################################

# video-sync:
# audio, display-resample, display-vdrop, display-desync
video-sync=display-resample

# manually set monitor refresh rate
#display-fps-override=60

interpolation=yes

# tscale filters:
# mitchell (balanced)
# oversample (sharp)
# catmull-rom
# linear (fast)
tscale=mitchell


############################################################
# SCALING / UPSCALING / DOWNSCALING
############################################################

# upscale algorithms:
# ewa_lanczossharp (very high quality)
# ewa_lanczos
# spline36
# spline16
# lanczos
# bilinear (fast)
# nearest (pixel art)
scale=spline36
cscale=ewa_lanczossharp

# downscale algorithms:
# mitchell
# spline36
# lanczos
# bilinear
dscale=mitchell

# anti-ringing strength (0–1)
scale-antiring=0.6
dscale-antiring=0.6
cscale-antiring=0.6

correct-downscaling=yes
linear-downscaling=no
sigmoid-upscaling=yes


############################################################
# PROFILES
############################################################

# default profile
[default]

# auto-enable deinterlacing if flagged interlaced
[interlaced]
profile-cond=video-params/interlaced
deinterlace=yes


############################################################
# FILE TYPE PROFILES
############################################################

[extension.gif]
cache=no
loop-file=yes
no-pause

[extension.webm]
loop-file=yes
no-pause


############################################################
# PROTOCOL-SPECIFIC (HTTP / YT-DLP)
############################################################

[protocol.http]
# 1080p max, prefer 60fps, prefer best audio
#ytdl-format=bestvideo[height<=1080][fps<=60]+bestaudio/best[height<=1080]

# 1080p max, exclude AV1, prefer VP9, prefer 60fps
ytdl-format=bestvideo[height<=1080][fps<=60][vcodec!=av01][vcodec^=vp9]+bestaudio/bestvideo[height<=1080][vcodec!=av01]+bestaudio/best[height<=1080]

# HLS bitrate:
# min, max, or numeric value
hls-bitrate=max

cache=yes

# prevent pause during buffering
#no-cache-pause

[protocol.https]
profile=protocol.http

[protocol.ytdl]
profile=protocol.http
